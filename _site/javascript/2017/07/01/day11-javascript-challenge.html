<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Favicon -->
  <link rel="icon" href="/favicon.png">
  <link rel="image_src" href="/images/personal_life.png">

  <!-- Meta information -->
  <title>Day 11: JavaScript Challenge</title>
  <meta name="description"
        content="I was very excited building custom HTML5 video player using vanilla JavaScript.Right now, I can say that it’s super tiring to rely on Web API alone withoutst...">
  <link rel="canonical"
        href="https://miayam.github.io/javascript/2017/07/01/day11-javascript-challenge" />

  <!-- hack.css -->
  <link rel="stylesheet" href="https://npmcdn.com/hack/dist/hack.css" />
  
    <link rel="stylesheet" href="https://npmcdn.com/hack/dist/standard.css" />
  

  <!-- Prism.js -->
  <link rel="stylesheet" href="https://npmcdn.com/prismjs@1.5.1/themes/prism.css" />

  <!-- Custom style -->
  <link rel="stylesheet" href="/css/main.css" />

  <!-- Feed -->
  <link rel="alternate" type="application/rss+xml" title="miayam.github.io"
        href="/feed.xml" />

  <!-- 'jekyll-seo' plugin -->
  <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Day 11: JavaScript Challenge - miayam.github.io</title>
<meta property="og:title" content="Day 11: JavaScript Challenge" />
<meta name="description" content="I was very excited building custom HTML5 video player using vanilla JavaScript.Right now, I can say that it’s super tiring to rely on Web API alone withoutstanding on the shoulders of giants (libraries).The most interesting part in this challenge was adding event listener to eventsI’ve never heard before! Here’s the demo.As usual, I can only let the code explain itself.HTML&lt;main&gt;   &lt;div class=&quot;player&quot;&gt;     &lt;video class=&quot;player__video viewer&quot; src=&quot;lovely.mp4&quot;&gt;&lt;/video&gt;     &lt;div class=&quot;player__controls&quot;&gt;       &lt;div class=&quot;progress&quot;&gt;        &lt;div class=&quot;progress__filled&quot;&gt;&lt;/div&gt;       &lt;/div&gt;       &lt;button class=&quot;player__button toggle&quot; title=&quot;Toggle Play&quot;&gt;▷&lt;/button&gt;       &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot; min=&quot;0&quot; max=&quot;1&quot; step=&quot;0.05&quot; value=&quot;1&quot;&gt;       &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot; min=&quot;0.5&quot; max=&quot;2&quot; step=&quot;0.1&quot; value=&quot;1&quot;&gt;       &lt;button data-skip=&quot;-10&quot; class=&quot;player__button player__button--skip&quot;&gt;« 10s&lt;/button&gt;       &lt;button data-skip=&quot;25&quot; class=&quot;player__button player__button--skip&quot;&gt;25s »&lt;/button&gt;       &lt;button class=&quot;player__button player__button--fullscreen&quot;&gt;&amp;#11034;&lt;/button&gt;     &lt;/div&gt;   &lt;/div&gt;&lt;/main&gt;JavaScript(function (window, undefined) {  // Simplify the method&#39;s name for readibility&#39;s sake.  var className = &#39;getElementsByClassName&#39;;  var selector = &#39;querySelector&#39;;    var videoPlayer = document[selector](&#39;.player&#39;);  var videoViewer = videoPlayer[selector](&#39;.viewer&#39;);  var progressBar = videoPlayer[selector](&#39;.progress&#39;);  var progressBarFilled = videoPlayer[selector](&#39;.progress__filled&#39;);  var fullscreen = videoPlayer[selector](&#39;.player__button--fullscreen&#39;);  var playOrPauseButton = videoPlayer[selector](&#39;.toggle&#39;);  var sliders = videoPlayer[className](&#39;player__slider&#39;);  var skipButtons = videoPlayer[className](&#39;player__button--skip&#39;);  var isVideoPlayed = false;  // It&#39;s for mapping DOM elements. The Array.prototype.forEach won&#39;t  // work with NodeList.  function forEach(callback) {    for (var i = 0; i &lt; this.length; i++) {      callback.call(this, this[i], i);    }  }  function playOrPauseToggle() {    var method = videoViewer.paused ? &#39;play&#39; : &#39;pause&#39;;    videoViewer[method]();  }  function handleSliderUpdate() {    // This function listens to various events on elements that    // have `player__slider` included inside their class     // attribute&#39;s value.    //    // Here&#39;s the markup:    //    &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot;&gt; and    //    &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot;&gt;    //    // &#39;this.name&#39; must be either &#39;volume&#39; or &#39;playbackRate&#39;.    //    // Video&#39;s volume and playback rate changed as we click or move    // their corresponding slider back and forth. We assign its value    // (&#39;this.value&#39;) to either &#39;videoViewer.volume&#39; or    // &#39;videoViewer.playbackRate&#39; property.    //     // For more about &quot;volume&quot; and &quot;playbackRate&quot;:    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement    videoViewer[this.name] = this.value;  }  function progressBarOnPlaying() {    var ratio = parseFloat(this.currentTime / this.duration);    var currentProgressBar = ratio * 100;    progressBarFilled.style.flexBasis = `${currentProgressBar}%`;  }  function togglePlayOrPauseButton() {    var button = videoViewer.paused ? &#39;▷&#39; : &#39;▯▯&#39;;    playOrPauseButton.textContent = button;  }  function skipTheVideo() {    videoViewer.currentTime += parseInt(this.dataset.skip);  }  // Display video at specific time as the progress bar moved or clicked.  // Here&#39;s the example http://bit.ly/2txq2Sh  function scrubTheTimeline(event) {    var ratio = event.offsetX / this.offsetWidth;    var time = ratio * videoViewer.duration;    videoViewer.currentTime = time;  }  function toggleFullscreen() {    if (videoViewer.requestFullScreen){      videoViewer.requestFullScreen();    } else if(videoViewer.webkitRequestFullScreen){      videoViewer.webkitRequestFullScreen();    } else if(videoViewer.mozRequestFullScreen){      videoViewer.mozRequestFullScreen();    }  }  // Video viewer you watch the video from. Click the viewer and  // you see it paused or played under your control. The progress  // bar moves in accord to video&#39;s current time, so on until its  // duration ends. If the viewer clicked and video played, &#39;▯▯&#39;  // shown and &#39;▷&#39; hidden. Thing goes the other way round if the  // viewer clicked and video paused.  videoViewer.addEventListener(&#39;click&#39;, playOrPauseToggle);  videoViewer.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);  videoViewer.addEventListener(&#39;timeupdate&#39;, progressBarOnPlaying);  // A button dedicated to toggle video player. Play or pause the  // video as you wish. If the button clicked and video played,  // &#39;▯▯&#39; shown and &#39;▷&#39; hidden. Thing goes the other way round if  // the button clicked and video paused.  playOrPauseButton.addEventListener(&#39;click&#39;, playOrPauseToggle);  playOrPauseButton.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);  // Moving colored bar informs users that the video is playing.  // You can play the video back and forth by clicking or moving  // the mouse on progress bar.  progressBar.addEventListener(&#39;click&#39;, scrubTheTimeline);  progressBar.addEventListener(&#39;mousemove&#39;, function (event) {    if (!isVideoPlayed) {      return;    }    scrubTheTimeline.call(this, event);  });  progressBar.addEventListener(&#39;mousedown&#39;, function () {    isVideoPlayed = true;  });  progressBar.addEventListener(&#39;mouseup&#39;, function () {    isVideoPlayed = false;  });  // Sliders for controlling volume (louder or softer)  // and playback rate (faster or slower).  forEach.call(sliders, function (slider) {    slider.addEventListener(&#39;mousemove&#39;, handleSliderUpdate);    slider.addEventListener(&#39;change&#39;, handleSliderUpdate);  });  // Buttons for skipping the video back and forth.  forEach.call(skipButtons, function (skipButton) {    skipButton.addEventListener(&#39;click&#39;, skipTheVideo);  });  // Watch the video fullscreen (it&#39;s taking up the whole screen).  fullscreen.addEventListener(&#39;click&#39;, toggleFullscreen);})(window);I wanted to display this video from repository (jekyll page asset), but itdidn’t seem to work. I had tried embedding video file from Google Drive,but it only works well with iframe. I gave up, so I turned this lovely videointo a gif and it worked (github page doesn’t allow video file maybe…).Enjoy the video, enjoy my spaghetti code. See you next time." />
<meta property="og:description" content="I was very excited building custom HTML5 video player using vanilla JavaScript.Right now, I can say that it’s super tiring to rely on Web API alone withoutstanding on the shoulders of giants (libraries).The most interesting part in this challenge was adding event listener to eventsI’ve never heard before! Here’s the demo.As usual, I can only let the code explain itself.HTML&lt;main&gt;   &lt;div class=&quot;player&quot;&gt;     &lt;video class=&quot;player__video viewer&quot; src=&quot;lovely.mp4&quot;&gt;&lt;/video&gt;     &lt;div class=&quot;player__controls&quot;&gt;       &lt;div class=&quot;progress&quot;&gt;        &lt;div class=&quot;progress__filled&quot;&gt;&lt;/div&gt;       &lt;/div&gt;       &lt;button class=&quot;player__button toggle&quot; title=&quot;Toggle Play&quot;&gt;▷&lt;/button&gt;       &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot; min=&quot;0&quot; max=&quot;1&quot; step=&quot;0.05&quot; value=&quot;1&quot;&gt;       &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot; min=&quot;0.5&quot; max=&quot;2&quot; step=&quot;0.1&quot; value=&quot;1&quot;&gt;       &lt;button data-skip=&quot;-10&quot; class=&quot;player__button player__button--skip&quot;&gt;« 10s&lt;/button&gt;       &lt;button data-skip=&quot;25&quot; class=&quot;player__button player__button--skip&quot;&gt;25s »&lt;/button&gt;       &lt;button class=&quot;player__button player__button--fullscreen&quot;&gt;&amp;#11034;&lt;/button&gt;     &lt;/div&gt;   &lt;/div&gt;&lt;/main&gt;JavaScript(function (window, undefined) {  // Simplify the method&#39;s name for readibility&#39;s sake.  var className = &#39;getElementsByClassName&#39;;  var selector = &#39;querySelector&#39;;    var videoPlayer = document[selector](&#39;.player&#39;);  var videoViewer = videoPlayer[selector](&#39;.viewer&#39;);  var progressBar = videoPlayer[selector](&#39;.progress&#39;);  var progressBarFilled = videoPlayer[selector](&#39;.progress__filled&#39;);  var fullscreen = videoPlayer[selector](&#39;.player__button--fullscreen&#39;);  var playOrPauseButton = videoPlayer[selector](&#39;.toggle&#39;);  var sliders = videoPlayer[className](&#39;player__slider&#39;);  var skipButtons = videoPlayer[className](&#39;player__button--skip&#39;);  var isVideoPlayed = false;  // It&#39;s for mapping DOM elements. The Array.prototype.forEach won&#39;t  // work with NodeList.  function forEach(callback) {    for (var i = 0; i &lt; this.length; i++) {      callback.call(this, this[i], i);    }  }  function playOrPauseToggle() {    var method = videoViewer.paused ? &#39;play&#39; : &#39;pause&#39;;    videoViewer[method]();  }  function handleSliderUpdate() {    // This function listens to various events on elements that    // have `player__slider` included inside their class     // attribute&#39;s value.    //    // Here&#39;s the markup:    //    &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot;&gt; and    //    &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot;&gt;    //    // &#39;this.name&#39; must be either &#39;volume&#39; or &#39;playbackRate&#39;.    //    // Video&#39;s volume and playback rate changed as we click or move    // their corresponding slider back and forth. We assign its value    // (&#39;this.value&#39;) to either &#39;videoViewer.volume&#39; or    // &#39;videoViewer.playbackRate&#39; property.    //     // For more about &quot;volume&quot; and &quot;playbackRate&quot;:    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement    videoViewer[this.name] = this.value;  }  function progressBarOnPlaying() {    var ratio = parseFloat(this.currentTime / this.duration);    var currentProgressBar = ratio * 100;    progressBarFilled.style.flexBasis = `${currentProgressBar}%`;  }  function togglePlayOrPauseButton() {    var button = videoViewer.paused ? &#39;▷&#39; : &#39;▯▯&#39;;    playOrPauseButton.textContent = button;  }  function skipTheVideo() {    videoViewer.currentTime += parseInt(this.dataset.skip);  }  // Display video at specific time as the progress bar moved or clicked.  // Here&#39;s the example http://bit.ly/2txq2Sh  function scrubTheTimeline(event) {    var ratio = event.offsetX / this.offsetWidth;    var time = ratio * videoViewer.duration;    videoViewer.currentTime = time;  }  function toggleFullscreen() {    if (videoViewer.requestFullScreen){      videoViewer.requestFullScreen();    } else if(videoViewer.webkitRequestFullScreen){      videoViewer.webkitRequestFullScreen();    } else if(videoViewer.mozRequestFullScreen){      videoViewer.mozRequestFullScreen();    }  }  // Video viewer you watch the video from. Click the viewer and  // you see it paused or played under your control. The progress  // bar moves in accord to video&#39;s current time, so on until its  // duration ends. If the viewer clicked and video played, &#39;▯▯&#39;  // shown and &#39;▷&#39; hidden. Thing goes the other way round if the  // viewer clicked and video paused.  videoViewer.addEventListener(&#39;click&#39;, playOrPauseToggle);  videoViewer.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);  videoViewer.addEventListener(&#39;timeupdate&#39;, progressBarOnPlaying);  // A button dedicated to toggle video player. Play or pause the  // video as you wish. If the button clicked and video played,  // &#39;▯▯&#39; shown and &#39;▷&#39; hidden. Thing goes the other way round if  // the button clicked and video paused.  playOrPauseButton.addEventListener(&#39;click&#39;, playOrPauseToggle);  playOrPauseButton.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);  // Moving colored bar informs users that the video is playing.  // You can play the video back and forth by clicking or moving  // the mouse on progress bar.  progressBar.addEventListener(&#39;click&#39;, scrubTheTimeline);  progressBar.addEventListener(&#39;mousemove&#39;, function (event) {    if (!isVideoPlayed) {      return;    }    scrubTheTimeline.call(this, event);  });  progressBar.addEventListener(&#39;mousedown&#39;, function () {    isVideoPlayed = true;  });  progressBar.addEventListener(&#39;mouseup&#39;, function () {    isVideoPlayed = false;  });  // Sliders for controlling volume (louder or softer)  // and playback rate (faster or slower).  forEach.call(sliders, function (slider) {    slider.addEventListener(&#39;mousemove&#39;, handleSliderUpdate);    slider.addEventListener(&#39;change&#39;, handleSliderUpdate);  });  // Buttons for skipping the video back and forth.  forEach.call(skipButtons, function (skipButton) {    skipButton.addEventListener(&#39;click&#39;, skipTheVideo);  });  // Watch the video fullscreen (it&#39;s taking up the whole screen).  fullscreen.addEventListener(&#39;click&#39;, toggleFullscreen);})(window);I wanted to display this video from repository (jekyll page asset), but itdidn’t seem to work. I had tried embedding video file from Google Drive,but it only works well with iframe. I gave up, so I turned this lovely videointo a gif and it worked (github page doesn’t allow video file maybe…).Enjoy the video, enjoy my spaghetti code. See you next time." />
<link rel="canonical" href="https://miayam.github.io/javascript/2017/07/01/day11-javascript-challenge" />
<meta property="og:url" content="https://miayam.github.io/javascript/2017/07/01/day11-javascript-challenge" />
<meta property="og:site_name" content="miayam.github.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-07-01T00:00:00+07:00" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Day 11: JavaScript Challenge",
    "datePublished": "2017-07-01T00:00:00+07:00",
    "description": "I was very excited building custom HTML5 video player using vanilla JavaScript.Right now, I can say that it’s super tiring to rely on Web API alone withoutstanding on the shoulders of giants (libraries).The most interesting part in this challenge was adding event listener to eventsI’ve never heard before! Here’s the demo.As usual, I can only let the code explain itself.HTML&lt;main&gt;   &lt;div class=&quot;player&quot;&gt;     &lt;video class=&quot;player__video viewer&quot; src=&quot;lovely.mp4&quot;&gt;&lt;/video&gt;     &lt;div class=&quot;player__controls&quot;&gt;       &lt;div class=&quot;progress&quot;&gt;        &lt;div class=&quot;progress__filled&quot;&gt;&lt;/div&gt;       &lt;/div&gt;       &lt;button class=&quot;player__button toggle&quot; title=&quot;Toggle Play&quot;&gt;▷&lt;/button&gt;       &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot; min=&quot;0&quot; max=&quot;1&quot; step=&quot;0.05&quot; value=&quot;1&quot;&gt;       &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot; min=&quot;0.5&quot; max=&quot;2&quot; step=&quot;0.1&quot; value=&quot;1&quot;&gt;       &lt;button data-skip=&quot;-10&quot; class=&quot;player__button player__button--skip&quot;&gt;« 10s&lt;/button&gt;       &lt;button data-skip=&quot;25&quot; class=&quot;player__button player__button--skip&quot;&gt;25s »&lt;/button&gt;       &lt;button class=&quot;player__button player__button--fullscreen&quot;&gt;&amp;#11034;&lt;/button&gt;     &lt;/div&gt;   &lt;/div&gt;&lt;/main&gt;JavaScript(function (window, undefined) {  // Simplify the method&#39;s name for readibility&#39;s sake.  var className = &#39;getElementsByClassName&#39;;  var selector = &#39;querySelector&#39;;    var videoPlayer = document[selector](&#39;.player&#39;);  var videoViewer = videoPlayer[selector](&#39;.viewer&#39;);  var progressBar = videoPlayer[selector](&#39;.progress&#39;);  var progressBarFilled = videoPlayer[selector](&#39;.progress__filled&#39;);  var fullscreen = videoPlayer[selector](&#39;.player__button--fullscreen&#39;);  var playOrPauseButton = videoPlayer[selector](&#39;.toggle&#39;);  var sliders = videoPlayer[className](&#39;player__slider&#39;);  var skipButtons = videoPlayer[className](&#39;player__button--skip&#39;);  var isVideoPlayed = false;  // It&#39;s for mapping DOM elements. The Array.prototype.forEach won&#39;t  // work with NodeList.  function forEach(callback) {    for (var i = 0; i &lt; this.length; i++) {      callback.call(this, this[i], i);    }  }  function playOrPauseToggle() {    var method = videoViewer.paused ? &#39;play&#39; : &#39;pause&#39;;    videoViewer[method]();  }  function handleSliderUpdate() {    // This function listens to various events on elements that    // have `player__slider` included inside their class     // attribute&#39;s value.    //    // Here&#39;s the markup:    //    &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot;&gt; and    //    &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot;&gt;    //    // &#39;this.name&#39; must be either &#39;volume&#39; or &#39;playbackRate&#39;.    //    // Video&#39;s volume and playback rate changed as we click or move    // their corresponding slider back and forth. We assign its value    // (&#39;this.value&#39;) to either &#39;videoViewer.volume&#39; or    // &#39;videoViewer.playbackRate&#39; property.    //     // For more about &quot;volume&quot; and &quot;playbackRate&quot;:    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement    videoViewer[this.name] = this.value;  }  function progressBarOnPlaying() {    var ratio = parseFloat(this.currentTime / this.duration);    var currentProgressBar = ratio * 100;    progressBarFilled.style.flexBasis = `${currentProgressBar}%`;  }  function togglePlayOrPauseButton() {    var button = videoViewer.paused ? &#39;▷&#39; : &#39;▯▯&#39;;    playOrPauseButton.textContent = button;  }  function skipTheVideo() {    videoViewer.currentTime += parseInt(this.dataset.skip);  }  // Display video at specific time as the progress bar moved or clicked.  // Here&#39;s the example http://bit.ly/2txq2Sh  function scrubTheTimeline(event) {    var ratio = event.offsetX / this.offsetWidth;    var time = ratio * videoViewer.duration;    videoViewer.currentTime = time;  }  function toggleFullscreen() {    if (videoViewer.requestFullScreen){      videoViewer.requestFullScreen();    } else if(videoViewer.webkitRequestFullScreen){      videoViewer.webkitRequestFullScreen();    } else if(videoViewer.mozRequestFullScreen){      videoViewer.mozRequestFullScreen();    }  }  // Video viewer you watch the video from. Click the viewer and  // you see it paused or played under your control. The progress  // bar moves in accord to video&#39;s current time, so on until its  // duration ends. If the viewer clicked and video played, &#39;▯▯&#39;  // shown and &#39;▷&#39; hidden. Thing goes the other way round if the  // viewer clicked and video paused.  videoViewer.addEventListener(&#39;click&#39;, playOrPauseToggle);  videoViewer.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);  videoViewer.addEventListener(&#39;timeupdate&#39;, progressBarOnPlaying);  // A button dedicated to toggle video player. Play or pause the  // video as you wish. If the button clicked and video played,  // &#39;▯▯&#39; shown and &#39;▷&#39; hidden. Thing goes the other way round if  // the button clicked and video paused.  playOrPauseButton.addEventListener(&#39;click&#39;, playOrPauseToggle);  playOrPauseButton.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);  // Moving colored bar informs users that the video is playing.  // You can play the video back and forth by clicking or moving  // the mouse on progress bar.  progressBar.addEventListener(&#39;click&#39;, scrubTheTimeline);  progressBar.addEventListener(&#39;mousemove&#39;, function (event) {    if (!isVideoPlayed) {      return;    }    scrubTheTimeline.call(this, event);  });  progressBar.addEventListener(&#39;mousedown&#39;, function () {    isVideoPlayed = true;  });  progressBar.addEventListener(&#39;mouseup&#39;, function () {    isVideoPlayed = false;  });  // Sliders for controlling volume (louder or softer)  // and playback rate (faster or slower).  forEach.call(sliders, function (slider) {    slider.addEventListener(&#39;mousemove&#39;, handleSliderUpdate);    slider.addEventListener(&#39;change&#39;, handleSliderUpdate);  });  // Buttons for skipping the video back and forth.  forEach.call(skipButtons, function (skipButton) {    skipButton.addEventListener(&#39;click&#39;, skipTheVideo);  });  // Watch the video fullscreen (it&#39;s taking up the whole screen).  fullscreen.addEventListener(&#39;click&#39;, toggleFullscreen);})(window);I wanted to display this video from repository (jekyll page asset), but itdidn’t seem to work. I had tried embedding video file from Google Drive,but it only works well with iframe. I gave up, so I turned this lovely videointo a gif and it worked (github page doesn’t allow video file maybe…).Enjoy the video, enjoy my spaghetti code. See you next time.",
    "url": "https://miayam.github.io/javascript/2017/07/01/day11-javascript-challenge"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>



  
    <body class="standard">
  

    <div class="container">
      <div class="grid">
        <aside class="cell -3of12" role="navigation">
          <div class="logo">
            <a href="/" class="logo_link">
              <img src="/images/personal_life.png" style="height: 165px" title="Back to the home page...">
            </a>
            <span class="bullshit">Delicious Meal for Thought</span>
          </div>
          <div class="t-hackcss-navigation">
  <h2 class="t-hackcss-navigation-heading">Main Menu</h2>

  <nav class="menu" role="menubar">
    
    
      <a class="menu-item "
        role="menuitem" href="/" title="">
        Home <div class="pull-right">»</div>
      </a>
    
      <a class="menu-item "
        role="menuitem" href="/about" title="">
        About <div class="pull-right">»</div>
      </a>
    
      <a class="menu-item "
        role="menuitem" href="/archive" title="">
        Archive <div class="pull-right">»</div>
      </a>
    
  </nav>
</div>

        </aside>

        <main class="cell -9of12">
          <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Day 11: JavaScript Challenge</h1>
    <p class="post-meta">
      <time datetime="2017-07-01T00:00:00+07:00"
            itemprop="datePublished"
            class="media-heading">
        1 July 2017
      </time>

      <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">written by <a href="https://github.com/miayam">Muhammad D. Ramadhan</a></span>
      </span>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>I was very excited building custom HTML5 video player using vanilla JavaScript.
Right now, I can say that it’s super tiring to rely on Web API alone without
standing on the shoulders of giants (libraries).</p>

<p><img src="/images/ohno.jpg" alt="Oh no!" class="blog-post-image" /></p>

<p>The most interesting part in this challenge was adding event listener to events
I’ve never heard before! Here’s the <a href="/demo_day11" target="_blank">demo</a>.</p>

<p>As usual, I can only let the code explain itself.</p>

<h3 id="html">HTML</h3>
<noscript><pre>&lt;main&gt; 
  &lt;div class=&quot;player&quot;&gt;
     &lt;video class=&quot;player__video viewer&quot; src=&quot;lovely.mp4&quot;&gt;&lt;/video&gt;

     &lt;div class=&quot;player__controls&quot;&gt;
       &lt;div class=&quot;progress&quot;&gt;
        &lt;div class=&quot;progress__filled&quot;&gt;&lt;/div&gt;
       &lt;/div&gt;
       &lt;button class=&quot;player__button toggle&quot; title=&quot;Toggle Play&quot;&gt;▷&lt;/button&gt;
       &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot; min=&quot;0&quot; max=&quot;1&quot; step=&quot;0.05&quot; value=&quot;1&quot;&gt;
       &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot; min=&quot;0.5&quot; max=&quot;2&quot; step=&quot;0.1&quot; value=&quot;1&quot;&gt;
       &lt;button data-skip=&quot;-10&quot; class=&quot;player__button player__button--skip&quot;&gt;« 10s&lt;/button&gt;
       &lt;button data-skip=&quot;25&quot; class=&quot;player__button player__button--skip&quot;&gt;25s »&lt;/button&gt;
       &lt;button class=&quot;player__button player__button--fullscreen&quot;&gt;&amp;#11034;&lt;/button&gt;
     &lt;/div&gt;
   &lt;/div&gt;
&lt;/main&gt;</pre></noscript>
<script src="https://gist.github.com/miayam/fec9b797c34d57410bf2c2102c910716.js"> </script>

<h3 id="javascript">JavaScript</h3>
<noscript><pre>(function (window, undefined) {
  // Simplify the method&#39;s name for readibility&#39;s sake.
  var className = &#39;getElementsByClassName&#39;;
  var selector = &#39;querySelector&#39;;
  
  var videoPlayer = document[selector](&#39;.player&#39;);
  var videoViewer = videoPlayer[selector](&#39;.viewer&#39;);
  var progressBar = videoPlayer[selector](&#39;.progress&#39;);
  var progressBarFilled = videoPlayer[selector](&#39;.progress__filled&#39;);
  var fullscreen = videoPlayer[selector](&#39;.player__button--fullscreen&#39;);
  var playOrPauseButton = videoPlayer[selector](&#39;.toggle&#39;);
  var sliders = videoPlayer[className](&#39;player__slider&#39;);
  var skipButtons = videoPlayer[className](&#39;player__button--skip&#39;);
  var isVideoPlayed = false;

  // It&#39;s for mapping DOM elements. The Array.prototype.forEach won&#39;t
  // work with NodeList.
  function forEach(callback) {
    for (var i = 0; i &lt; this.length; i++) {
      callback.call(this, this[i], i);
    }
  }

  function playOrPauseToggle() {
    var method = videoViewer.paused ? &#39;play&#39; : &#39;pause&#39;;
    videoViewer[method]();
  }

  function handleSliderUpdate() {
    // This function listens to various events on elements that
    // have `player__slider` included inside their class 
    // attribute&#39;s value.
    //
    // Here&#39;s the markup:
    //    &lt;input type=&quot;range&quot; name=&quot;volume&quot; class=&quot;player__slider&quot;&gt; and
    //    &lt;input type=&quot;range&quot; name=&quot;playbackRate&quot; class=&quot;player__slider&quot;&gt;
    //
    // &#39;this.name&#39; must be either &#39;volume&#39; or &#39;playbackRate&#39;.
    //
    // Video&#39;s volume and playback rate changed as we click or move
    // their corresponding slider back and forth. We assign its value
    // (&#39;this.value&#39;) to either &#39;videoViewer.volume&#39; or
    // &#39;videoViewer.playbackRate&#39; property.
    // 
    // For more about &quot;volume&quot; and &quot;playbackRate&quot;:
    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement
    videoViewer[this.name] = this.value;
  }

  function progressBarOnPlaying() {
    var ratio = parseFloat(this.currentTime / this.duration);
    var currentProgressBar = ratio * 100;
    progressBarFilled.style.flexBasis = `${currentProgressBar}%`;
  }

  function togglePlayOrPauseButton() {
    var button = videoViewer.paused ? &#39;▷&#39; : &#39;▯▯&#39;;
    playOrPauseButton.textContent = button;
  }

  function skipTheVideo() {
    videoViewer.currentTime += parseInt(this.dataset.skip);
  }

  // Display video at specific time as the progress bar moved or clicked.
  // Here&#39;s the example http://bit.ly/2txq2Sh
  function scrubTheTimeline(event) {
    var ratio = event.offsetX / this.offsetWidth;
    var time = ratio * videoViewer.duration;
    videoViewer.currentTime = time;
  }

  function toggleFullscreen() {
    if (videoViewer.requestFullScreen){
      videoViewer.requestFullScreen();
    } else if(videoViewer.webkitRequestFullScreen){
      videoViewer.webkitRequestFullScreen();
    } else if(videoViewer.mozRequestFullScreen){
      videoViewer.mozRequestFullScreen();
    }
  }

  // Video viewer you watch the video from. Click the viewer and
  // you see it paused or played under your control. The progress
  // bar moves in accord to video&#39;s current time, so on until its
  // duration ends. If the viewer clicked and video played, &#39;▯▯&#39;
  // shown and &#39;▷&#39; hidden. Thing goes the other way round if the
  // viewer clicked and video paused.
  videoViewer.addEventListener(&#39;click&#39;, playOrPauseToggle);
  videoViewer.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);
  videoViewer.addEventListener(&#39;timeupdate&#39;, progressBarOnPlaying);

  // A button dedicated to toggle video player. Play or pause the
  // video as you wish. If the button clicked and video played,
  // &#39;▯▯&#39; shown and &#39;▷&#39; hidden. Thing goes the other way round if
  // the button clicked and video paused.
  playOrPauseButton.addEventListener(&#39;click&#39;, playOrPauseToggle);
  playOrPauseButton.addEventListener(&#39;click&#39;, togglePlayOrPauseButton);

  // Moving colored bar informs users that the video is playing.
  // You can play the video back and forth by clicking or moving
  // the mouse on progress bar.
  progressBar.addEventListener(&#39;click&#39;, scrubTheTimeline);
  progressBar.addEventListener(&#39;mousemove&#39;, function (event) {
    if (!isVideoPlayed) {
      return;
    }

    scrubTheTimeline.call(this, event);
  });
  progressBar.addEventListener(&#39;mousedown&#39;, function () {
    isVideoPlayed = true;
  });
  progressBar.addEventListener(&#39;mouseup&#39;, function () {
    isVideoPlayed = false;
  });

  // Sliders for controlling volume (louder or softer)
  // and playback rate (faster or slower).
  forEach.call(sliders, function (slider) {
    slider.addEventListener(&#39;mousemove&#39;, handleSliderUpdate);
    slider.addEventListener(&#39;change&#39;, handleSliderUpdate);
  });

  // Buttons for skipping the video back and forth.
  forEach.call(skipButtons, function (skipButton) {
    skipButton.addEventListener(&#39;click&#39;, skipTheVideo);
  });

  // Watch the video fullscreen (it&#39;s taking up the whole screen).
  fullscreen.addEventListener(&#39;click&#39;, toggleFullscreen);
})(window);</pre></noscript>
<script src="https://gist.github.com/miayam/97782afd8e12cc453ac8fbef5b3b0b00.js"> </script>

<p>I wanted to display this video from repository (jekyll page asset), but it
didn’t seem to work. I had tried embedding video file from Google Drive,
but it only works well with <code class="highlighter-rouge">iframe</code>. I gave up, so I turned this lovely video
into a <code class="highlighter-rouge">gif</code> and it worked (github page doesn’t allow video file maybe…).</p>

<p><img src="/images/lovely.gif" alt="Oh no more!" class="blog-post-image" /></p>

<p>Enjoy the video, enjoy my spaghetti code. See you next time.</p>

  </div>

  <div class="blog-navigation">
    <hr>
    
      <a href="/javascript/2017/06/30/day10-javascript-challenge" class="blog-navigation__previous-link">&laquo; Day 10: JavaScript Challenge</a>
    
    
      <a href="/javascript/2017/07/03/day12-javascript-challenge" class="blog-navigation__next-link"> Day 12: JavaScript Challenge &raquo;</a>
    
  </div>
</article>

<section>
  <div class="fb-comments" data-href="https://miayam.github.io/javascript/2017/07/01/day11-javascript-challenge" data-width="100%" data-numposts="10">
  </div>
</section>

        </main>
      </div>

    <footer class="t-hackcss-footer">
  <div class="cell -12of12">
    <div class="contact-list">
    </div>
  </div>
</footer>


    </div>

    <!-- Prism.js -->
    <script src="https://npmcdn.com/prismjs@1.5.1/prism.js"></script>
  </body>
  <div id="fb-root"></div>
  <script>
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) {
        d.getElementById('loading').style.display = "none";
        return;
      }
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.9&appId=676883012507478";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</html>
